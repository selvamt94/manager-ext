(("undefined"!==typeof self?self:this)["webpackJsonpneuvector_ui_ext_1_1_0"]=("undefined"!==typeof self?self:this)["webpackJsonpneuvector_ui_ext_1_1_0"]||[]).push([[6],{a6b8:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));var s=a("aab4"),n=a("f4b0");async function i(t){if(0===t.getters["neuvector/hosts"].length){await Object(n["b"])(t);let e=await Object(s["b"])();t.dispatch("neuvector/updateHosts",r(e.data.hosts))}}function r(t){let e=new Map;return t.forEach(t=>{Object.values(t.interfaces).forEach(a=>{a.forEach(a=>{e.set(a.ip,t)})}),e.set(t.name,t)}),e}},aab4:function(t,e,a){"use strict";a.d(e,"b",(function(){return r})),a.d(e,"a",(function(){return o}));var s=a("827a"),n=a("f4b0"),i=a("49bf");async function r(){return Object(s["a"])({url:Object(n["j"])(i["a"].NODES_URL),method:"get"})}async function o(t){return Object(s["a"])({url:Object(n["j"])(i["a"].SCAN_HOST_URL),method:"get",params:{id:t}})}},b5f9:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("div",[t.vulnerabilities&&t.vulnerabilities.length>0?e("VulnerabilitiesGrid",{attrs:{vulnerabilities:t.vulnerabilities,csvFileName:t.rancherHostName}}):e("div",[e("Banner",{staticClass:"type-banner mb-20 mt-0",attrs:{color:"warning",label:t.t("general.NO_ROWS")}})],1)],1)},n=[],i=a("aab4"),r=a("a6b8"),o=a("6418"),l=a("aada"),c={components:{Banner:o["a"],VulnerabilitiesGrid:l["a"]},props:{host:Object,isLightTheme:Boolean},async fetch(){try{console.log("Get host vulnerabilities...",this.host);let t="";if(this.host)t=this.host.nvId,this.rancherHostName=this.host.id;else{let e=this.$store.getters["neuvector/hosts"];e&&0!==e.length||(await Object(r["a"])(this.$store),e=this.$store.getters["neuvector/hosts"]);let a=location.pathname.split("/"),s=a[a.length-1];e.has(s)&&(t=e.get(s).id),this.rancherHostName=s}const e=this.$store.getters["neuvector/scannedNodeMap"];if(e.has(t))this.vulnerabilities=e.get(t);else{let e=await Object(i["a"])(t);this.vulnerabilities=e.data.report.vulnerabilities,this.$store.dispatch("neuvector/updateScannedNodeMap",{nodeID:t,scannedResult:this.vulnerabilities})}}catch(t){console.error(t)}},data(){return{vulnerabilities:null,rancherHostName:""}}},u=c,h=a("d802"),b=Object(h["a"])(u,s,n,!1,null,null,null);e["default"]=b.exports}}]);
//# sourceMappingURL=neuvector-ui-ext-1.1.0.umd.min.6.js.map